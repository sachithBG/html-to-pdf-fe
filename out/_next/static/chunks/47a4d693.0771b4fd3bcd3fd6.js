"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6133],{76869:(e,t,i)=>{i.d(t,{B8:()=>Q,t0:()=>eL,y4:()=>ew});var r=i(51736),s=i(61940),n=i(50585),l=i(96948),o=i(7840),a=i(72395),u=i(71375);class d{_startElement;_referenceIndent;_isForward;_includeSelf;_sameAttributes;_sameIndent;_lowerIndent;_higherIndent;constructor(e,t){this._startElement=e,this._referenceIndent=e.getAttribute("listIndent"),this._isForward="forward"==t.direction,this._includeSelf=!!t.includeSelf,this._sameAttributes=(0,l.$r)(t.sameAttributes||[]),this._sameIndent=!!t.sameIndent,this._lowerIndent=!!t.lowerIndent,this._higherIndent=!!t.higherIndent}static first(e,t){let i=new this(e,t)[Symbol.iterator]();return(0,l.$1)(i)}*[Symbol.iterator](){let e=[];for(let{node:t}of c(this._getStartNode(),this._isForward?"forward":"backward")){let i=t.getAttribute("listIndent");if(i<this._referenceIndent){if(!this._lowerIndent)break;this._referenceIndent=i}else if(i>this._referenceIndent){if(!this._higherIndent)continue;if(!this._isForward){e.push(t);continue}}else{if(!this._sameIndent){if(this._higherIndent){e.length&&(yield*e,e.length=0);break}continue}if(this._sameAttributes.some(e=>t.getAttribute(e)!==this._startElement.getAttribute(e)))break}e.length&&(yield*e,e.length=0),yield t}}_getStartNode(){return this._includeSelf?this._startElement:this._isForward?this._startElement.nextSibling:this._startElement.previousSibling}}function*c(e,t="forward"){let i="forward"==t,r=[],s=null;for(;p(e);){let t=null;if(s){let i=e.getAttribute("listIndent"),n=s.getAttribute("listIndent");i>n?r[n]=s:i<n?(t=r[i],r.length=i):t=s}yield{node:e,previous:s,previousNodeInList:t},s=e,e=i?e.nextSibling:e.previousSibling}}class m{_listHead;constructor(e){this._listHead=e}[Symbol.iterator](){return c(this._listHead,"forward")}}class h{static next(){return(0,l.Ld)()}}function p(e){return!!e&&e.is("element")&&e.hasAttribute("listItemId")}function f(e,t={}){return[...g(e,{...t,direction:"backward"}),...g(e,{...t,direction:"forward"})]}function g(e,t={}){let i="forward"==t.direction,r=Array.from(new d(e,{...t,includeSelf:i,sameIndent:!0,sameAttributes:"listItemId"}));return i?r:r.reverse()}function b(e,t){let i=new d(e,{sameIndent:!0,sameAttributes:"listType",...t}),r=new d(e,{sameIndent:!0,sameAttributes:"listType",includeSelf:!0,direction:"forward",...t});return[...Array.from(i).reverse(),...r]}function y(e){return!d.first(e,{sameIndent:!0,sameAttributes:"listItemId"})}function w(e){return!d.first(e,{direction:"forward",sameIndent:!0,sameAttributes:"listItemId"})}function v(e,t={}){e=(0,l.$r)(e);let i=!1!==t.withNested,r=new Set;for(let t of e)for(let e of f(t,{higherIndent:i}))r.add(e);return S(r)}function A(e){e=(0,l.$r)(e);let t=new Set;for(let i of e)for(let e of b(i))t.add(e);return S(t)}function I(e,t){let i=g(e,{direction:"forward"}),r=h.next();for(let e of i)t.setAttribute("listItemId",r,e);return i}function k(e,t,i){let r={};for(let[e,i]of t.getAttributes())e.startsWith("list")&&(r[e]=i);let s=g(e,{direction:"forward"});for(let e of s)i.setAttributes(r,e);return s}function x(e,t,{expand:i,indentBy:r=1}={}){e=(0,l.$r)(e);let s=i?v(e):e;for(let e of s){let i=e.getAttribute("listIndent")+r;i<0?T(e,t):t.setAttribute("listIndent",i,e)}return s}function T(e,t){for(let i of e=(0,l.$r)(e))i.is("element","listItem")&&t.rename(i,"paragraph");for(let i of e)for(let e of i.getAttributeKeys())e.startsWith("list")&&t.removeAttribute(e,i);return e}function _(e){if(!e.length)return!1;let t=e[0].getAttribute("listItemId");return!!t&&!e.some(e=>e.getAttribute("listItemId")!=t)}function S(e){return Array.from(e).filter(e=>"$graveyard"!==e.root.rootName).sort((e,t)=>e.index-t.index)}function V(e){let t=e.document.selection.getSelectedElement();return t&&e.schema.isObject(t)&&e.schema.isBlock(t)?t:null}function L(e,t){return t.checkChild(e.parent,"listItem")&&t.checkChild(e,"$text")&&!t.isObject(e)}function E(e){return"numbered"==e||"customNumbered"==e}class C extends r.uB{_direction;constructor(e,t){super(e),this._direction=t}refresh(){this.isEnabled=this._checkEnabled()}execute(){let e=this.editor.model,t=P(e.document.selection);e.change(e=>{let i=[];for(let r of(_(t)&&!y(t[0])?("forward"==this._direction&&i.push(...x(t,e)),i.push(...I(t[0],e))):"forward"==this._direction?i.push(...x(t,e,{expand:!0})):i.push(...function(e,t){let i=v(e=(0,l.$r)(e)),r=new Set,s=Math.min(...i.map(e=>e.getAttribute("listIndent"))),n=new Map;for(let e of i)n.set(e,d.first(e,{lowerIndent:!0}));for(let e of i){if(r.has(e))continue;r.add(e);let i=e.getAttribute("listIndent")-1;if(i<0){T(e,t);continue}if(e.getAttribute("listIndent")==s){var o;let i=g(o=n.get(e),{direction:"forward"}).pop().index>e.index?k(e,o,t):[];for(let e of i)r.add(e);if(i.length)continue}t.setAttribute("listIndent",i,e)}return S(r)}(t,e)),i)){if(!r.hasAttribute("listType"))continue;let t=d.first(r,{sameIndent:!0});t&&e.setAttribute("listType",t.getAttribute("listType"),r)}this._fireAfterExecute(i)})}_fireAfterExecute(e){this.fire("afterExecute",S(new Set(e)))}_checkEnabled(){let e=P(this.editor.model.document.selection),t=e[0];if(!t)return!1;if("backward"==this._direction||_(e)&&!y(e[0]))return!0;t=(e=v(e))[0];let i=d.first(t,{sameIndent:!0});return!!i&&i.getAttribute("listType")==t.getAttribute("listType")}}function P(e){let t=Array.from(e.getSelectedBlocks()),i=t.findIndex(e=>!p(e));return -1!=i&&(t.length=i),t}class z extends r.uB{type;_listWalkerOptions;constructor(e,t,i={}){super(e),this.type=t,this._listWalkerOptions=i.multiLevel?{higherIndent:!0,lowerIndent:!0,sameAttributes:[]}:void 0}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){let t=this.editor.model,i=t.document,r=V(t),s=Array.from(i.selection.getSelectedBlocks()).filter(e=>t.schema.checkAttribute(e,"listType")||L(e,t.schema)),n=void 0!==e.forceValue?!e.forceValue:this.value;t.change(l=>{if(n){let e=s[s.length-1],t=g(e,{direction:"forward"}),i=[];t.length>1&&i.push(...I(t[1],l)),i.push(...T(s,l)),i.push(...function(e,t){let i=[],r=Number.POSITIVE_INFINITY;for(let{node:s}of c(e.nextSibling,"forward")){let e=s.getAttribute("listIndent");if(0==e)break;e<r&&(r=e);let n=e-r;t.setAttribute("listIndent",n,s),i.push(s)}return i}(e,l)),this._fireAfterExecute(i)}else if((r||i.selection.isCollapsed)&&p(s[0])){let t=b(r||s[0],this._listWalkerOptions);for(let i of t)l.setAttributes({...e.additionalAttributes,listType:this.type},i);this._fireAfterExecute(t)}else{let i=[];for(let r of s)if(r.hasAttribute("listType"))for(let t of v(r,{withNested:!1}))t.getAttribute("listType")!=this.type&&(l.setAttributes({...e.additionalAttributes,listType:this.type},t),i.push(t));else!r.is("element","listItem")&&L(r,t.schema)&&l.rename(r,"listItem"),l.setAttributes({...e.additionalAttributes,listIndent:0,listItemId:h.next(),listType:this.type},r),i.push(r);this._fireAfterExecute(i)}})}_fireAfterExecute(e){this.fire("afterExecute",S(new Set(e)))}_getValue(){let e=Array.from(this.editor.model.document.selection.getSelectedBlocks());if(!e.length)return!1;for(let t of e)if(t.getAttribute("listType")!=this.type)return!1;return!0}_checkEnabled(){let e=this.editor.model,t=e.schema,i=Array.from(e.document.selection.getSelectedBlocks());if(!i.length)return!1;if(this.value)return!0;for(let e of i)if(t.checkAttribute(e,"listType")||L(e,t))return!0;return!1}}class B extends r.uB{_direction;constructor(e,t){super(e),this._direction=t}refresh(){this.isEnabled=this._checkEnabled()}execute({shouldMergeOnBlocksContentLevel:e=!1}={}){let t=this.editor.model,i=t.document.selection,r=[];t.change(s=>{let{firstElement:n,lastElement:l}=this._getMergeSubjectElements(i,e),o=n.getAttribute("listIndent")||0,a=l.getAttribute("listIndent"),u=l.getAttribute("listItemId");if(o!=a){let e=Array.from(new d(l,{direction:"forward",higherIndent:!0}));r.push(...x([l,...e],s,{indentBy:o-a,expand:o<a}))}if(e){let e=i;i.isCollapsed&&(e=s.createSelection(s.createRange(s.createPositionAt(n,"end"),s.createPositionAt(l,0)))),t.deleteContent(e,{doNotResetEntireContent:i.isCollapsed});let o=e.getLastPosition().parent,a=o.nextSibling;r.push(o),a&&a!==l&&a.getAttribute("listItemId")==u&&r.push(...k(a,o,s))}else r.push(...k(l,n,s));this._fireAfterExecute(r)})}_fireAfterExecute(e){this.fire("afterExecute",S(new Set(e)))}_checkEnabled(){let e=this.editor.model,t=e.document.selection,i=V(e);if(t.isCollapsed||i){let e=i||t.getFirstPosition().parent;if(!p(e))return!1;let r="backward"==this._direction?e.previousSibling:e.nextSibling;if(!r||_([e,r]))return!1}else{let e=t.getLastPosition(),i=t.getFirstPosition();if(e.parent===i.parent||!p(e.parent))return!1}return!0}_getMergeSubjectElements(e,t){let i,r;let s=V(this.editor.model);if(e.isCollapsed||s){let n=s||e.getFirstPosition().parent,l=y(n);"backward"==this._direction?(r=n,i=l&&!t?d.first(n,{sameIndent:!0,lowerIndent:!0}):n.previousSibling):(i=n,r=n.nextSibling)}else i=e.getFirstPosition().parent,r=e.getLastPosition().parent;return{firstElement:i,lastElement:r}}}class N extends r.uB{_direction;constructor(e,t){super(e),this._direction=t}refresh(){this.isEnabled=this._checkEnabled()}execute(){this.editor.model.change(e=>{let t=I(this._getStartBlock(),e);this._fireAfterExecute(t)})}_fireAfterExecute(e){this.fire("afterExecute",S(new Set(e)))}_checkEnabled(){let e=this.editor.model.document.selection,t=this._getStartBlock();return e.isCollapsed&&p(t)&&!y(t)}_getStartBlock(){let e=this.editor.model.document.selection.getFirstPosition().parent;return"before"==this._direction?e:e.nextSibling}}class O extends r.k_{static get pluginName(){return"ListUtils"}static get isOfficialPlugin(){return!0}expandListBlocksToCompleteList(e){return A(e)}isFirstBlockOfListItem(e){return y(e)}isListItemBlock(e){return p(e)}expandListBlocksToCompleteItems(e,t={}){return v(e,t)}isNumberedListType(e){return E(e)}}function H(e){return e.is("element","li")}function M(e){return"numbered"==e||"customNumbered"==e?"ol":"ul"}function F(e,t){return`list-${e}-${t}`}function R(e,t){let i=e.nodeBefore;if(p(i)){let e=i;for(let{node:i}of c(e,"backward"))if(e=i,t.has(e))return;t.set(i,e)}else{let i=e.nodeAfter;p(i)&&t.set(i,i)}}function $(e,t,i,{dataPipeline:r}={}){let s=(t,i)=>{let r=[];for(let i of e)t.hasAttribute(i)&&r.push(`attribute:${i}`);return!!r.every(e=>!1!==i.test(t,e))&&(r.forEach(e=>i.consume(t,e)),!0)};return(n,l,o)=>{let{writer:a,mapper:u,consumable:c}=o,m=l.item;if(!e.includes(l.attributeKey)||!s(m,c))return;let h=function(e,t,i){let r=i.createRangeOn(e);return t.toViewRange(r).getTrimmed().end.nodeBefore}(m,u,i);W(h,a,u),function(e,t){let i=e.parent;for(;i.is("attributeElement")&&["ul","ol","li"].includes(i.name);){let r=i.parent;t.unwrap(t.createRangeOn(e),i),i=r}}(h,a);let p=function(e,t,i,r,{dataPipeline:s}){let n=r.createRangeOn(t);if(!y(e))return n;for(let l of i){if("itemMarker"!=l.scope)continue;let i=l.createElement(r,e,{dataPipeline:s});if(!i||(r.setCustomProperty("listItemMarker",!0,i),l.canInjectMarkerIntoElement&&l.canInjectMarkerIntoElement(e)?r.insert(r.createPositionAt(t,0),i):(r.insert(n.start,i),n=r.createRange(r.createPositionBefore(i),r.createPositionAfter(t))),!l.createWrapperElement||!l.canWrapElement))continue;let o=l.createWrapperElement(r,e,{dataPipeline:s});r.setCustomProperty("listItemWrapper",!0,o),l.canWrapElement(e)?n=r.wrap(n,o):(n=r.wrap(r.createRangeOn(i),o),n=r.createRange(n.start,r.createPositionAfter(t)))}return n}(m,h,t,a,{dataPipeline:r});!function(e,t,i,r){if(!e.hasAttribute("listIndent"))return;let s=e.getAttribute("listIndent"),n=e;for(let e=s;e>=0;e--){var l,o;let s=(l=e,o=n.getAttribute("listItemId"),r.createAttributeElement("li",null,{priority:(2*l+1)/100-100,id:o})),a=function(e,t,i,r=F(i,t)){return e.createAttributeElement(M(i),null,{priority:2*t/100-100,id:r})}(r,e,n.getAttribute("listType"));for(let e of i)("list"==e.scope||"item"==e.scope)&&n.hasAttribute(e.attributeName)&&e.setAttributeOnDowncast(r,n.getAttribute(e.attributeName),"list"==e.scope?a:s);if(t=r.wrap(t,s),t=r.wrap(t,a),0==e||!(n=d.first(n,{lowerIndent:!0})))break}}(m,p,t,a)}}function D(e,{dataPipeline:t}={}){return(i,{writer:r})=>{if(!j(i,e))return null;if(!t)return r.createContainerElement("span",{class:"ck-list-bogus-paragraph"});let s=r.createContainerElement("p");return r.setCustomProperty("dataPipeline:transparentRendering",!0,s),s}}function W(e,t,i){for(;e.parent.is("attributeElement")&&e.parent.getCustomProperty("listItemWrapper");)t.unwrap(t.createRangeOn(e),e.parent);let r=[];for(let i of(s(t.createPositionBefore(e).getWalker({direction:"backward"})),s(t.createRangeIn(e).getWalker()),r))t.remove(i);function s(e){for(let{item:t}of e){if(t.is("element")&&i.toModelElement(t))break;t.is("element")&&t.getCustomProperty("listItemMarker")&&r.push(t)}}}function j(e,t,i=f(e)){if(!p(e))return!1;for(let i of e.getAttributeKeys())if(!i.startsWith("selection:")&&!t.includes(i))return!1;return i.length<2}let K=["listType","listIndent","listItemId"];class U extends r.k_{_downcastStrategies=[];static get pluginName(){return"ListEditing"}static get isOfficialPlugin(){return!0}static get requires(){return[n.x,s.ep,O,o.xz]}constructor(e){super(e),e.config.define("list.multiBlock",!0)}init(){let e=this.editor,t=e.model,i=e.config.get("list.multiBlock");if(e.plugins.has("LegacyListEditing"))throw new l.Yb("list-feature-conflict",this,{conflictPlugin:"LegacyListEditing"});for(let e of(t.schema.register("$listItem",{allowAttributes:K}),i?(t.schema.extend("$container",{allowAttributesOf:"$listItem"}),t.schema.extend("$block",{allowAttributesOf:"$listItem"}),t.schema.extend("$blockObject",{allowAttributesOf:"$listItem"})):t.schema.register("listItem",{inheritAllFrom:"$block",allowAttributesOf:"$listItem"}),K))t.schema.setAttributeProperties(e,{copyOnReplace:!0});e.commands.add("numberedList",new z(e,"numbered")),e.commands.add("bulletedList",new z(e,"bulleted")),e.commands.add("customNumberedList",new z(e,"customNumbered",{multiLevel:!0})),e.commands.add("customBulletedList",new z(e,"customBulleted",{multiLevel:!0})),e.commands.add("indentList",new C(e,"forward")),e.commands.add("outdentList",new C(e,"backward")),e.commands.add("splitListItemBefore",new N(e,"before")),e.commands.add("splitListItemAfter",new N(e,"after")),i&&(e.commands.add("mergeListItemBackward",new B(e,"backward")),e.commands.add("mergeListItemForward",new B(e,"forward"))),this._setupDeleteIntegration(),this._setupEnterIntegration(),this._setupTabIntegration(),this._setupClipboardIntegration(),this._setupAccessibilityIntegration()}afterInit(){let e=this.editor.commands,t=e.get("indent"),i=e.get("outdent");t&&t.registerChildCommand(e.get("indentList"),{priority:"high"}),i&&i.registerChildCommand(e.get("outdentList"),{priority:"lowest"}),this._setupModelPostFixing(),this._setupConversion()}registerDowncastStrategy(e){this._downcastStrategies.push(e)}getListAttributeNames(){return[...K,...this._downcastStrategies.map(e=>e.attributeName)]}_setupDeleteIntegration(){let e=this.editor,t=e.commands.get("mergeListItemBackward"),i=e.commands.get("mergeListItemForward");this.listenTo(e.editing.view.document,"delete",(r,s)=>{let n=e.model.document.selection;V(e.model)||e.model.change(()=>{let l=n.getFirstPosition();if(n.isCollapsed&&"backward"==s.direction){if(!l.isAtStart)return;let i=l.parent;if(!p(i))return;if(d.first(i,{sameAttributes:"listType",sameIndent:!0})||0!==i.getAttribute("listIndent")){if(!t||!t.isEnabled)return;t.execute({shouldMergeOnBlocksContentLevel:q(e.model,"backward")})}else w(i)||e.execute("splitListItemAfter"),e.execute("outdentList");s.preventDefault(),r.stop()}else{if(n.isCollapsed&&!n.getLastPosition().isAtEnd||!i||!i.isEnabled)return;i.execute({shouldMergeOnBlocksContentLevel:q(e.model,"forward")}),s.preventDefault(),r.stop()}})},{context:"li"})}_setupEnterIntegration(){let e=this.editor,t=e.model,i=e.commands,r=i.get("enter");this.listenTo(e.editing.view.document,"enter",(i,r)=>{let s=t.document,n=s.selection.getFirstPosition().parent;if(s.selection.isCollapsed&&p(n)&&n.isEmpty&&!r.isSoft){let t=y(n),s=w(n);t&&s?(e.execute("outdentList"),r.preventDefault(),i.stop()):t&&!s?(e.execute("splitListItemAfter"),r.preventDefault(),i.stop()):s&&(e.execute("splitListItemBefore"),r.preventDefault(),i.stop())}},{context:"li"}),this.listenTo(r,"afterExecute",()=>{let t=i.get("splitListItemBefore");t.refresh(),t.isEnabled&&2===f(e.model.document.selection.getLastPosition().parent).length&&t.execute()})}_setupTabIntegration(){let e=this.editor;this.listenTo(e.editing.view.document,"tab",(t,i)=>{let r=i.shiftKey?"outdentList":"indentList";this.editor.commands.get(r).isEnabled&&(e.execute(r),i.stopPropagation(),i.preventDefault(),t.stop())},{context:"li"})}_setupConversion(){var e,t;let i=this.editor,r=i.model,s=this.getListAttributeNames(),n=i.config.get("list.multiBlock"),l=n?"paragraph":"listItem";i.conversion.for("upcast").elementToElement({view:"li",model:(e,{writer:t})=>t.createElement(l,{listType:""})}).elementToElement({view:"p",model:(e,{writer:t})=>e.parent&&e.parent.is("element","li")?t.createElement(l,{listType:""}):null,converterPriority:"high"}).add(e=>{e.on("element:li",(e,t,i)=>{let{writer:r,schema:s}=i;if(!t.modelRange)return;let n=Array.from(t.modelRange.getItems({shallow:!0})).filter(e=>s.checkAttribute(e,"listItemId"));if(!n.length)return;let l=h.next(),o=function(e){let t=0,i=e.parent;for(;i;){if(H(i))t++;else{let e=i.previousSibling;e&&H(e)&&t++}i=i.parent}return t}(t.viewItem),a=t.viewItem.parent&&t.viewItem.parent.is("element","ol")?"numbered":"bulleted",u=n[0].getAttribute("listType");u&&(a=u);let d={listItemId:l,listIndent:o,listType:a};for(let e of n)e.hasAttribute("listItemId")||r.setAttributes(d,e);n.length>1&&n[1].getAttribute("listItemId")!=d.listItemId&&i.keepEmptyElement(n[0])})}),n||i.conversion.for("downcast").elementToElement({model:"listItem",view:"p"}),i.conversion.for("editingDowncast").elementToElement({model:l,view:D(s),converterPriority:"high"}).add(e=>{var t;e.on("attribute",$(s,this._downcastStrategies,r)),e.on("remove",(t=r.schema,(e,i,r)=>{let{writer:s,mapper:n}=r,l=e.name.split(":")[1];if(!t.checkAttribute(l,"listItemId"))return;let o=n.toViewPosition(i.position),a=i.position.getShiftedBy(i.length),u=n.toViewPosition(a,{isPhantom:!0}),d=s.createRange(o,u).getTrimmed().end.nodeBefore;d&&W(d,s,n)}))}),i.conversion.for("dataDowncast").elementToElement({model:l,view:D(s,{dataPipeline:!0}),converterPriority:"high"}).add(e=>{e.on("attribute",$(s,this._downcastStrategies,r,{dataPipeline:!0}))});let o=(e=this._downcastStrategies,t=i.editing.view,(i,r)=>{if(r.modelPosition.offset>0)return;let s=r.modelPosition.parent;if(!p(s)||!e.some(e=>"itemMarker"==e.scope&&e.canInjectMarkerIntoElement&&e.canInjectMarkerIntoElement(s)))return;let n=r.mapper.toViewElement(s),l=t.createRangeIn(n),o=l.getWalker(),a=l.start;for(let{item:e}of o){if(e.is("element")&&r.mapper.toModelElement(e)||e.is("$textProxy"))break;e.is("element")&&e.getCustomProperty("listItemMarker")&&(a=t.createPositionAfter(e),o.skip(({previousPosition:e})=>!e.isEqual(a)))}r.viewPosition=a});i.editing.mapper.on("modelToViewPosition",o),i.data.mapper.on("modelToViewPosition",o),this.listenTo(r.document,"change:data",function(e,t,i,r){return()=>{let n=e.document.differ.getChanges(),l=[],o=new Map,a=new Set;for(let e of n)if("insert"==e.type&&"$text"!=e.name)R(e.position,o),e.attributes.has("listItemId")?a.add(e.position.nodeAfter):R(e.position.getShiftedBy(e.length),o);else if("remove"==e.type&&e.attributes.has("listItemId"))R(e.position,o);else if("attribute"==e.type){let t=e.range.start.nodeAfter;i.includes(e.attributeKey)?(R(e.range.start,o),null===e.attributeNewValue?(R(e.range.start.getShiftedBy(1),o),s(t)&&l.push(t)):a.add(t)):p(t)&&s(t)&&l.push(t)}for(let e of o.values())l.push(...function(e,n){let l=[],o=new Set,a=[];for(let{node:u,previous:d}of c(e,"forward")){if(o.has(u))continue;let e=u.getAttribute("listIndent");d&&e<d.getAttribute("listIndent")&&(a.length=e+1),a[e]=Object.fromEntries(Array.from(u.getAttributes()).filter(([e])=>i.includes(e)));let c=g(u,{direction:"forward"});for(let e of c)o.add(e),s(e,c)?l.push(e):function(e,i,s){if(s.has(e))return!1;let n=t.mapper.toViewElement(e),l=i.length-1;for(let e=n.parent;!e.is("editableElement");e=e.parent){var o;let t=H(e),s=(o=e).is("element","ol")||o.is("element","ul");if(!s&&!t)continue;let n=`checkAttributes:${t?"item":"list"}`;if(r.fire(n,{viewElement:e,modelAttributes:i[l]}))break;if(s&&--l<0)return!1}return!0}(e,a,n)&&l.push(e)}return l}(e,a));for(let e of new Set(l))t.reconvertItem(e)};function s(e,s){let n=t.mapper.toViewElement(e);if(!n)return!1;if(r.fire("checkElement",{modelElement:e,viewElement:n}))return!0;if(!e.is("element","paragraph")&&!e.is("element","listItem"))return!1;let l=j(e,i,s);return!!(l&&n.is("element","p"))||!!(!l&&n.is("element","span"))}}(r,i.editing,s,this),{priority:"high"}),this.on("checkAttributes:item",(e,{viewElement:t,modelAttributes:i})=>{t.id!=i.listItemId&&(e.return=!0,e.stop())}),this.on("checkAttributes:list",(e,{viewElement:t,modelAttributes:i})=>{(t.name!=M(i.listType)||t.id!=F(i.listType,i.listIndent))&&(e.return=!0,e.stop())})}_setupModelPostFixing(){let e=this.editor.model,t=this.getListAttributeNames();e.document.registerPostFixer(i=>(function(e,t,i,r){let s=e.document.differ.getChanges(),n=new Map,l=r.editor.config.get("list.multiBlock"),o=!1;for(let r of s){if("insert"==r.type&&"$text"!=r.name){let s=r.position.nodeAfter;if(!e.schema.checkAttribute(s,"listItemId"))for(let e of Array.from(s.getAttributeKeys()))i.includes(e)&&(t.removeAttribute(e,s),o=!0);for(let{item:t,previousPosition:i}of(R(r.position,n),r.attributes.has("listItemId")||R(r.position.getShiftedBy(r.length),n),e.createRangeIn(s)))p(t)&&R(i,n)}else"remove"==r.type?R(r.position,n):"attribute"==r.type&&i.includes(r.attributeKey)&&(R(r.range.start,n),null===r.attributeNewValue&&R(r.range.start.getShiftedBy(1),n));if(!l&&"attribute"==r.type&&K.includes(r.attributeKey)){let e=r.range.start.nodeAfter;null===r.attributeNewValue&&e&&e.is("element","listItem")?(t.rename(e,"paragraph"),o=!0):null===r.attributeOldValue&&e&&e.is("element")&&"listItem"!=e.name&&(t.rename(e,"listItem"),o=!0)}}let a=new Set;for(let e of n.values())o=r.fire("postFixer",{listNodes:new m(e),listHead:e,writer:t,seenIds:a})||o;return o})(e,i,t,this)),this.on("postFixer",(e,{listNodes:t,writer:i})=>{e.return=function(e,t){let i=0,r=-1,s=null,n=!1;for(let{node:l}of e){let e=l.getAttribute("listIndent");if(e>i){let o;null===s?(s=e-i,o=i):(s>e&&(s=e),o=e-s),o>r+1&&(o=r+1),t.setAttribute("listIndent",o,l),n=!0,r=o}else s=null,i=e+1,r=e}return n}(t,i)||e.return},{priority:"high"}),this.on("postFixer",(e,{listNodes:t,writer:i,seenIds:r})=>{e.return=function(e,t,i){let r=new Set,s=!1;for(let{node:n}of e){if(r.has(n))continue;let e=n.getAttribute("listType"),l=n.getAttribute("listItemId");if(t.has(l)&&(l=h.next()),t.add(l),n.is("element","listItem")){n.getAttribute("listItemId")!=l&&(i.setAttribute("listItemId",l,n),s=!0);continue}for(let t of g(n,{direction:"forward"}))r.add(t),t.getAttribute("listType")!=e&&(l=h.next(),e=t.getAttribute("listType")),t.getAttribute("listItemId")!=l&&(i.setAttribute("listItemId",l,t),s=!0)}return s}(t,r,i)||e.return},{priority:"high"})}_setupClipboardIntegration(){let e=this.editor.model,t=this.editor.plugins.get("ClipboardPipeline");this.listenTo(e,"insertContent",(t,[i,r])=>{let s;let n=i.is("documentFragment")?Array.from(i.getChildren()):[i];if(!n.length)return;let l=(r?e.createSelection(r):e.document.selection).getFirstPosition();if(p(l.parent))s=l.parent;else{if(!p(l.nodeBefore))return;s=l.nodeBefore}e.change(e=>{let t=s.getAttribute("listType"),i=Math.max(s.getAttribute("listIndent")-(n[0].getAttribute("listIndent")||0),0);for(let r of n){let n=p(r);s.is("element","listItem")&&r.is("element","paragraph")&&e.rename(r,"listItem"),e.setAttributes({listIndent:(n?r.getAttribute("listIndent"):0)+i,listItemId:n?r.getAttribute("listItemId"):h.next(),listType:t},r)}})},{priority:"high"}),this.listenTo(t,"outputTransformation",(t,i)=>{e.change(e=>{let t=Array.from(i.content.getChildren()),r=t[t.length-1];if(t.length>1&&r.is("element")&&r.isEmpty&&t.slice(0,-1).every(p)&&e.remove(r),"copy"==i.method||"cut"==i.method){let t=Array.from(i.content.getChildren());_(t)&&T(t,e)}})})}_setupAccessibilityIntegration(){let e=this.editor,t=e.t;e.accessibility.addKeystrokeInfoGroup({id:"list",label:t("Keystrokes that can be used in a list"),keystrokes:[{label:t("Increase list item indent"),keystroke:"Tab"},{label:t("Decrease list item indent"),keystroke:"Shift+Tab"}]})}}function q(e,t){let i=e.document.selection;if(!i.isCollapsed)return!V(e);if("forward"===t)return!0;let r=i.getFirstPosition().parent,s=r.previousSibling;return!e.schema.isObject(s)&&(!!s.isEmpty||_([r,s]))}function Y(e,t,i,r){e.ui.componentFactory.add(t,()=>{let s=Z(a._,e,t,i,r);return s.set({tooltip:!0,isToggleable:!0}),s}),e.ui.componentFactory.add(`menuBar:${t}`,()=>{let s=Z(a.kS,e,t,i,r);return s.set({role:"menuitemcheckbox",isToggleable:!0}),s})}function Z(e,t,i,r,s){let n=t.commands.get(i),l=new e(t.locale);return l.set({label:r,icon:s}),l.bind("isOn","isEnabled").to(n,"value","isEnabled"),l.on("execute",()=>{t.execute(i),t.editing.view.focus()}),l}class G extends r.k_{static get pluginName(){return"ListUI"}static get isOfficialPlugin(){return!0}init(){let e=this.editor.t;this.editor.ui.componentFactory.has("numberedList")||Y(this.editor,"numberedList",e("Numbered List"),r.Pt.numberedList),this.editor.ui.componentFactory.has("bulletedList")||Y(this.editor,"bulletedList",e("Bulleted List"),r.Pt.bulletedList)}}class Q extends r.k_{static get requires(){return[U,G]}static get pluginName(){return"List"}static get isOfficialPlugin(){return!0}}class X extends r.uB{refresh(){let e=this._getValue();this.value=e,this.isEnabled=null!=e}execute({startIndex:e=1}={}){let t=this.editor.model,i=Array.from(t.document.selection.getSelectedBlocks()).filter(e=>p(e)&&E(e.getAttribute("listType")));i=A(i),t.change(t=>{for(let r of i)t.setAttribute("listStart",e>=0?e:1,r)})}_getValue(){let e=this.editor.model.document,t=(0,l.$1)(e.selection.getSelectedBlocks());return t&&p(t)&&E(t.getAttribute("listType"))?t.getAttribute("listStart"):null}}let J={},ee={},et={},ei=[{listStyle:"disc",typeAttribute:"disc",listType:"bulleted"},{listStyle:"circle",typeAttribute:"circle",listType:"bulleted"},{listStyle:"square",typeAttribute:"square",listType:"bulleted"},{listStyle:"decimal",typeAttribute:"1",listType:"numbered"},{listStyle:"decimal-leading-zero",typeAttribute:null,listType:"numbered"},{listStyle:"lower-roman",typeAttribute:"i",listType:"numbered"},{listStyle:"upper-roman",typeAttribute:"I",listType:"numbered"},{listStyle:"lower-alpha",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-alpha",typeAttribute:"A",listType:"numbered"},{listStyle:"lower-latin",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-latin",typeAttribute:"A",listType:"numbered"}];for(let{listStyle:e,typeAttribute:t,listType:i}of ei)J[e]=i,ee[e]=t,t&&(et[t]=e);function er(){return ei.map(e=>e.listStyle)}function es(e){return J[e]||null}function en(e){return ee[e]||null}class el extends r.uB{defaultType;_supportedTypes;constructor(e,t,i){super(e),this.defaultType=t,this._supportedTypes=i}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){let t=this.editor.model,i=t.document;t.change(t=>{this._tryToConvertItemsToList(e);let r=Array.from(i.selection.getSelectedBlocks()).filter(e=>e.hasAttribute("listType"));if(r.length)for(let i of r=A(r))t.setAttribute("listStyle",e.type||this.defaultType,i)})}isStyleTypeSupported(e){return!this._supportedTypes||this._supportedTypes.includes(e)}_getValue(){let e=(0,l.$1)(this.editor.model.document.selection.getSelectedBlocks());return p(e)?e.getAttribute("listStyle"):null}_checkEnabled(){let e=this.editor,t=e.commands.get("numberedList"),i=e.commands.get("bulletedList");return t.isEnabled||i.isEnabled}_tryToConvertItemsToList(e){if(!e.type)return;let t=es(e.type);if(!t)return;let i=this.editor,r=`${t}List`;i.commands.get(r).value||i.execute(r)}}class eo extends r.uB{refresh(){let e=this._getValue();this.value=e,this.isEnabled=null!=e}execute(e={}){let t=this.editor.model,i=Array.from(t.document.selection.getSelectedBlocks()).filter(e=>p(e)&&"numbered"==e.getAttribute("listType"));i=A(i),t.change(t=>{for(let r of i)t.setAttribute("listReversed",!!e.reversed,r)})}_getValue(){let e=this.editor.model.document,t=(0,l.$1)(e.selection.getSelectedBlocks());return p(t)&&"numbered"==t.getAttribute("listType")?t.getAttribute("listReversed"):null}}function ea(e){return(t,i,r)=>{let{writer:s,schema:n,consumable:l}=r;if(!1===l.test(i.viewItem,e.viewConsumables))return;i.modelRange||Object.assign(i,r.convertChildren(i.viewItem,i.modelCursor));let o=!1;for(let t of i.modelRange.getItems({shallow:!0}))!n.checkAttribute(t,e.attributeName)||!e.appliesToListItem(t)||t.hasAttribute(e.attributeName)||(s.setAttribute(e.attributeName,e.getAttributeOnUpcast(i.viewItem),t),o=!0);o&&l.consume(i.viewItem,e.viewConsumables)}}class eu extends r.k_{static get pluginName(){return"ListPropertiesUtils"}static get isOfficialPlugin(){return!0}getAllSupportedStyleTypes(){return er()}getListTypeFromListStyleType(e){return es(e)}getListStyleTypeFromTypeAttribute(e){return et[e]||null}getTypeAttributeFromListStyleType(e){return en(e)}}function ed(e){let{startIndex:t,reversed:i,styles:r}=e;return{styles:function(e){let t={listTypes:["bulleted","numbered"],useAttribute:!1};return!0===e||(e?Array.isArray(e)||"string"==typeof e?t.listTypes=(0,l.$r)(e):(t.listTypes=e.listTypes?(0,l.$r)(e.listTypes):t.listTypes,t.useAttribute=!!e.useAttribute):t.listTypes=[]),t}(r),startIndex:t||!1,reversed:i||!1}}let ec="default";class em extends r.k_{static get requires(){return[U,eu]}static get pluginName(){return"ListPropertiesEditing"}static get isOfficialPlugin(){return!0}constructor(e){super(e),e.config.define("list.properties",{styles:!0,startIndex:!1,reversed:!1})}init(){let e=this.editor,t=e.model,i=e.plugins.get(U),r=function(e){let t=[],i=ed(e);if(e.styles){let e=i.styles.useAttribute;t.push({attributeName:"listStyle",defaultValue:ec,viewConsumables:{styles:"list-style-type"},addCommand(t){let i=er();e&&(i=i.filter(e=>!!en(e))),t.commands.add("listStyle",new el(t,ec,i))},appliesToListItem:e=>"numbered"==e.getAttribute("listType")||"bulleted"==e.getAttribute("listType"),hasValidAttribute(e){if(!this.appliesToListItem(e))return!e.hasAttribute("listStyle");if(!e.hasAttribute("listStyle"))return!1;let t=e.getAttribute("listStyle");return t==ec||es(t)==e.getAttribute("listType")},setAttributeOnDowncast(t,i,r){if(i&&i!==ec){if(e){let e=en(i);if(e){t.setAttribute("type",e,r);return}}else{t.setStyle("list-style-type",i,r);return}}t.removeStyle("list-style-type",r),t.removeAttribute("type",r)},getAttributeOnUpcast(e){let t=e.getStyle("list-style-type");if(t)return t;let i=e.getAttribute("type");return i?et[i]||null:ec}})}return e.reversed&&t.push({attributeName:"listReversed",defaultValue:!1,viewConsumables:{attributes:"reversed"},addCommand(e){e.commands.add("listReversed",new eo(e))},appliesToListItem:e=>"numbered"==e.getAttribute("listType"),hasValidAttribute(e){return this.appliesToListItem(e)==e.hasAttribute("listReversed")},setAttributeOnDowncast(e,t,i){t?e.setAttribute("reversed","reversed",i):e.removeAttribute("reversed",i)},getAttributeOnUpcast:e=>e.hasAttribute("reversed")}),e.startIndex&&t.push({attributeName:"listStart",defaultValue:1,viewConsumables:{attributes:"start"},addCommand(e){e.commands.add("listStart",new X(e))},appliesToListItem:e=>E(e.getAttribute("listType")),hasValidAttribute(e){return this.appliesToListItem(e)==e.hasAttribute("listStart")},setAttributeOnDowncast(e,t,i){0==t||t>1?e.setAttribute("start",t,i):e.removeAttribute("start",i)},getAttributeOnUpcast(e){let t=e.getAttribute("start");return t>=0?t:1}}),t}(e.config.get("list.properties"));for(let s of r)s.addCommand(e),t.schema.extend("$listItem",{allowAttributes:s.attributeName}),i.registerDowncastStrategy({scope:"list",attributeName:s.attributeName,setAttributeOnDowncast(e,t,i){s.setAttributeOnDowncast(e,t,i)}});e.conversion.for("upcast").add(e=>{for(let t of r)e.on("element:ol",ea(t)),e.on("element:ul",ea(t))}),i.on("checkAttributes:list",(e,{viewElement:t,modelAttributes:i})=>{for(let s of r)s.getAttributeOnUpcast(t)!=i[s.attributeName]&&(e.return=!0,e.stop())}),this.listenTo(e.commands.get("indentList"),"afterExecute",(e,i)=>{t.change(e=>{for(let t of i)for(let i of r)i.appliesToListItem(t)&&e.setAttribute(i.attributeName,i.defaultValue,t)})}),i.on("postFixer",(e,{listNodes:t,writer:i})=>{for(let{node:s}of t)for(let t of r)t.hasValidAttribute(s)||(t.appliesToListItem(s)?i.setAttribute(t.attributeName,t.defaultValue,s):i.removeAttribute(t.attributeName,s),e.return=!0)}),i.on("postFixer",(e,{listNodes:t,writer:i})=>{for(let{node:s,previousNodeInList:n}of t)if(n&&n.getAttribute("listType")==s.getAttribute("listType"))for(let t of r){let{attributeName:r}=t;if(!t.appliesToListItem(s))continue;let l=n.getAttribute(r);s.getAttribute(r)!=l&&(i.setAttribute(r,l,s),e.return=!0)}})}}class eh extends a.Ss{children;stylesView=null;additionalPropertiesCollapsibleView=null;startIndexFieldView=null;reversedSwitchButtonView=null;focusTracker=new l.$x;keystrokes=new l.EP;focusables=new a.s3;focusCycler;constructor(e,{enabledProperties:t,styleButtonViews:i,styleGridAriaLabel:r}){super(e);let s=["ck","ck-list-properties"];this.children=this.createCollection(),this.focusCycler=new a.H({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),i&&i.length?(this.stylesView=this._createStylesView(i,r),this.children.add(this.stylesView)):s.push("ck-list-properties_without-styles"),(t.startIndex||t.reversed)&&(this._addNumberedListPropertyViews(t),s.push("ck-list-properties_with-numbered-properties")),this.setTemplate({tag:"div",attributes:{class:s},children:this.children})}render(){if(super.render(),this.stylesView){for(let e of(this.focusables.add(this.stylesView),this.focusTracker.add(this.stylesView.element),(this.startIndexFieldView||this.reversedSwitchButtonView)&&(this.focusables.add(this.children.last.buttonView),this.focusTracker.add(this.children.last.buttonView.element)),this.stylesView.children))this.stylesView.focusTracker.add(e.element);(0,a.l1)({keystrokeHandler:this.stylesView.keystrokes,focusTracker:this.stylesView.focusTracker,gridItems:this.stylesView.children,numberOfColumns:()=>l.Sf.window.getComputedStyle(this.stylesView.element).getPropertyValue("grid-template-columns").split(" ").length,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection})}if(this.startIndexFieldView){this.focusables.add(this.startIndexFieldView),this.focusTracker.add(this.startIndexFieldView.element);let e=e=>e.stopPropagation();this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e)}this.reversedSwitchButtonView&&(this.focusables.add(this.reversedSwitchButtonView),this.focusTracker.add(this.reversedSwitchButtonView.element)),this.keystrokes.listenTo(this.element)}focus(){this.focusCycler.focusFirst()}focusLast(){this.focusCycler.focusLast()}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}_createStylesView(e,t){let i=new a.Ss(this.locale);return i.children=i.createCollection(),i.children.addMany(e),i.setTemplate({tag:"div",attributes:{"aria-label":t,class:["ck","ck-list-styles-list"]},children:i.children}),i.children.delegate("execute").to(this),i.focus=function(){this.children.first.focus()},i.focusTracker=new l.$x,i.keystrokes=new l.EP,i.render(),i.keystrokes.listenTo(i.element),i}_addNumberedListPropertyViews(e){let t=this.locale.t,i=[];e.startIndex&&(this.startIndexFieldView=this._createStartIndexField(),i.push(this.startIndexFieldView)),e.reversed&&(this.reversedSwitchButtonView=this._createReversedSwitchButton(),i.push(this.reversedSwitchButtonView)),this.stylesView?(this.additionalPropertiesCollapsibleView=new a.Kn(this.locale,i),this.additionalPropertiesCollapsibleView.set({label:t("List properties"),isCollapsed:!0}),this.additionalPropertiesCollapsibleView.buttonView.bind("isEnabled").toMany(i,"isEnabled",(...e)=>e.some(e=>e)),this.additionalPropertiesCollapsibleView.buttonView.on("change:isEnabled",(e,t,i)=>{i||(this.additionalPropertiesCollapsibleView.isCollapsed=!0)}),this.children.add(this.additionalPropertiesCollapsibleView)):this.children.addMany(i)}_createStartIndexField(){let e=this.locale.t,t=new a.xE(this.locale,a.F_);return t.set({label:e("Start at"),class:"ck-numbered-list-properties__start-index"}),t.fieldView.set({min:0,step:1,value:1,inputMode:"numeric"}),t.fieldView.on("input",()=>{let i=t.fieldView.element,r=i.valueAsNumber;if(Number.isNaN(r)){t.errorText=e("Invalid start index value.");return}i.checkValidity()?this.fire("listStart",{startIndex:r}):t.errorText=e("Start index must be greater than 0.")}),t}_createReversedSwitchButton(){let e=this.locale.t,t=new a.Wm(this.locale);return t.set({withText:!0,label:e("Reversed order"),class:"ck-numbered-list-properties__reversed-order"}),t.delegate("execute").to(this,"listReversed"),t}}class ep extends r.k_{static get pluginName(){return"ListPropertiesUI"}static get isOfficialPlugin(){return!0}init(){let e=this.editor,t=e.locale.t,i=e.config.get("list.properties"),s=ed(i),n=s.styles.listTypes;if(n.includes("bulleted")){let i=[{label:t("Toggle the disc list style"),tooltip:t("Disc"),type:"disc",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11 27a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0-9a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0-9a3 3 0 1 1 0 6 3 3 0 0 1 0-6z"/></svg>'},{label:t("Toggle the circle list style"),tooltip:t("Circle"),type:"circle",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11 27a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm0-10a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm0-10a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4z"/></svg>'},{label:t("Toggle the square list style"),tooltip:t("Square"),type:"square",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M14 27v6H8v-6h6zm0-9v6H8v-6h6zm0-9v6H8V9h6z"/></svg>'}],n=t("Bulleted List"),l=t("Bulleted list styles toolbar"),o="bulletedList";e.ui.componentFactory.add(o,ef({editor:e,normalizedConfig:s,parentCommandName:o,buttonLabel:n,buttonIcon:r.Pt.bulletedList,styleGridAriaLabel:l,styleDefinitions:i})),e.ui.componentFactory.add(`menuBar:${o}`,eb({editor:e,normalizedConfig:s,parentCommandName:o,buttonLabel:n,styleGridAriaLabel:l,styleDefinitions:i}))}if(n.includes("numbered")||i.startIndex||i.reversed){let i=[{label:t("Toggle the decimal list style"),tooltip:t("Decimal"),type:"decimal",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M10.29 15V8.531H9.286c-.14.393-.4.736-.778 1.03-.378.295-.728.495-1.05.6v1.121a4.257 4.257 0 0 0 1.595-.936V15h1.235zm3.343 0v-1.235h-1.235V15h1.235zM11.3 24v-1.147H8.848c.064-.111.148-.226.252-.343.104-.117.351-.354.74-.712.39-.357.66-.631.81-.821.225-.288.39-.562.494-.824.104-.263.156-.539.156-.829 0-.51-.182-.936-.545-1.279-.363-.342-.863-.514-1.499-.514-.58 0-1.063.148-1.45.444-.387.296-.617.784-.69 1.463l1.23.124c.024-.36.112-.619.264-.774.153-.155.358-.233.616-.233.26 0 .465.074.613.222.148.148.222.36.222.635 0 .25-.085.501-.255.756-.126.185-.468.536-1.024 1.055-.692.641-1.155 1.156-1.389 1.544-.234.389-.375.8-.422 1.233H11.3zm2.333 0v-1.235h-1.235V24h1.235zM9.204 34.11c.615 0 1.129-.2 1.542-.598.413-.398.62-.88.62-1.446 0-.39-.11-.722-.332-.997a1.5 1.5 0 0 0-.886-.532c.619-.337.928-.788.928-1.353 0-.399-.151-.756-.453-1.073-.366-.386-.852-.58-1.459-.58a2.25 2.25 0 0 0-.96.2 1.617 1.617 0 0 0-.668.55c-.16.232-.28.544-.358.933l1.138.194c.032-.282.123-.495.272-.642.15-.146.33-.22.54-.22.215 0 .386.065.515.194s.193.302.193.518c0 .255-.087.46-.263.613-.176.154-.43.227-.765.218l-.136 1.006c.22-.061.409-.092.567-.092.24 0 .444.09.61.272.168.182.251.428.251.739 0 .328-.087.589-.261.782a.833.833 0 0 1-.644.29.841.841 0 0 1-.607-.242c-.167-.16-.27-.394-.307-.698l-1.196.145c.062.542.285.98.668 1.316.384.335.868.503 1.45.503zm4.43-.11v-1.235h-1.236V34h1.235z"/></svg>'},{label:t("Toggle the decimal with leading zero list style"),tooltip:t("Decimal with leading zero"),type:"decimal-leading-zero",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M5.714 15.11c.624 0 1.11-.22 1.46-.66.421-.533.632-1.408.632-2.627 0-1.222-.21-2.096-.629-2.624-.351-.445-.839-.668-1.463-.668-.624 0-1.11.22-1.459.66-.422.533-.633 1.406-.633 2.619 0 1.236.192 2.095.576 2.577.384.482.89.723 1.516.723zm0-1.024a.614.614 0 0 1-.398-.14c-.115-.094-.211-.283-.287-.565-.077-.283-.115-.802-.115-1.558s.043-1.294.128-1.613c.064-.246.155-.417.272-.512a.617.617 0 0 1 .4-.143.61.61 0 0 1 .398.143c.116.095.211.284.288.567.076.283.114.802.114 1.558s-.043 1.292-.128 1.608c-.064.246-.155.417-.272.512a.617.617 0 0 1-.4.143zm6.078.914V8.531H10.79c-.14.393-.4.736-.778 1.03-.378.295-.728.495-1.05.6v1.121a4.257 4.257 0 0 0 1.595-.936V15h1.235zm3.344 0v-1.235h-1.235V15h1.235zm-9.422 9.11c.624 0 1.11-.22 1.46-.66.421-.533.632-1.408.632-2.627 0-1.222-.21-2.096-.629-2.624-.351-.445-.839-.668-1.463-.668-.624 0-1.11.22-1.459.66-.422.533-.633 1.406-.633 2.619 0 1.236.192 2.095.576 2.577.384.482.89.723 1.516.723zm0-1.024a.614.614 0 0 1-.398-.14c-.115-.094-.211-.283-.287-.565-.077-.283-.115-.802-.115-1.558s.043-1.294.128-1.613c.064-.246.155-.417.272-.512a.617.617 0 0 1 .4-.143.61.61 0 0 1 .398.143c.116.095.211.284.288.567.076.283.114.802.114 1.558s-.043 1.292-.128 1.608c-.064.246-.155.417-.272.512a.617.617 0 0 1-.4.143zm7.088.914v-1.147H10.35c.065-.111.149-.226.253-.343.104-.117.35-.354.74-.712.39-.357.66-.631.81-.821.225-.288.39-.562.493-.824.104-.263.156-.539.156-.829 0-.51-.181-.936-.544-1.279-.364-.342-.863-.514-1.499-.514-.58 0-1.063.148-1.45.444-.387.296-.617.784-.69 1.463l1.23.124c.024-.36.112-.619.264-.774.152-.155.357-.233.615-.233.261 0 .465.074.613.222.148.148.222.36.222.635 0 .25-.085.501-.255.756-.126.185-.467.536-1.024 1.055-.691.641-1.154 1.156-1.388 1.544-.235.389-.375.8-.422 1.233h4.328zm2.334 0v-1.235h-1.235V24h1.235zM5.714 34.11c.624 0 1.11-.22 1.46-.66.421-.533.632-1.408.632-2.627 0-1.222-.21-2.096-.629-2.624-.351-.445-.839-.668-1.463-.668-.624 0-1.11.22-1.459.66-.422.533-.633 1.406-.633 2.619 0 1.236.192 2.095.576 2.577.384.482.89.723 1.516.723zm0-1.024a.614.614 0 0 1-.398-.14c-.115-.094-.211-.283-.287-.565-.077-.283-.115-.802-.115-1.558s.043-1.294.128-1.613c.064-.246.155-.417.272-.512a.617.617 0 0 1 .4-.143.61.61 0 0 1 .398.143c.116.095.211.284.288.567.076.283.114.802.114 1.558s-.043 1.292-.128 1.608c-.064.246-.155.417-.272.512a.617.617 0 0 1-.4.143zm4.992 1.024c.616 0 1.13-.2 1.543-.598.413-.398.62-.88.62-1.446 0-.39-.111-.722-.332-.997a1.5 1.5 0 0 0-.886-.532c.618-.337.927-.788.927-1.353 0-.399-.15-.756-.452-1.073-.366-.386-.853-.58-1.46-.58a2.25 2.25 0 0 0-.96.2 1.617 1.617 0 0 0-.667.55c-.16.232-.28.544-.359.933l1.139.194c.032-.282.123-.495.272-.642.15-.146.33-.22.54-.22.214 0 .386.065.515.194s.193.302.193.518c0 .255-.088.46-.264.613-.175.154-.43.227-.764.218l-.136 1.006c.22-.061.408-.092.566-.092.24 0 .444.09.611.272.167.182.25.428.25.739 0 .328-.086.589-.26.782a.833.833 0 0 1-.644.29.841.841 0 0 1-.607-.242c-.167-.16-.27-.394-.308-.698l-1.195.145c.062.542.284.98.668 1.316.384.335.867.503 1.45.503zm4.43-.11v-1.235h-1.235V34h1.235z"/></svg>'},{label:t("Toggle the lower–roman list style"),tooltip:t("Lower–roman"),type:"lower-roman",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11.88 8.7V7.558h-1.234V8.7h1.234zm0 5.3V9.333h-1.234V14h1.234zm2.5 0v-1.235h-1.234V14h1.235zm-4.75 4.7v-1.142H8.395V18.7H9.63zm0 5.3v-4.667H8.395V24H9.63zm2.5-5.3v-1.142h-1.234V18.7h1.235zm0 5.3v-4.667h-1.234V24h1.235zm2.501 0v-1.235h-1.235V24h1.235zM7.38 28.7v-1.142H6.145V28.7H7.38zm0 5.3v-4.667H6.145V34H7.38zm2.5-5.3v-1.142H8.646V28.7H9.88zm0 5.3v-4.667H8.646V34H9.88zm2.5-5.3v-1.142h-1.234V28.7h1.235zm0 5.3v-4.667h-1.234V34h1.235zm2.501 0v-1.235h-1.235V34h1.235z"/></svg>'},{label:t("Toggle the upper–roman list style"),tooltip:t("Upper-roman"),type:"upper-roman",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11.916 15V8.558h-1.301V15h1.3zm2.465 0v-1.235h-1.235V15h1.235zM9.665 25v-6.442h-1.3V25h1.3zm2.5 0v-6.442h-1.3V25h1.3zm2.466 0v-1.235h-1.235V25h1.235zm-7.216 9v-6.442h-1.3V34h1.3zm2.5 0v-6.442h-1.3V34h1.3zm2.501 0v-6.442h-1.3V34h1.3zm2.465 0v-1.235h-1.235V34h1.235z"/></svg>'},{label:t("Toggle the lower–latin list style"),tooltip:t("Lower-latin"),type:"lower-latin",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M9.62 14.105c.272 0 .528-.05.768-.153s.466-.257.677-.462c.009.024.023.072.044.145.047.161.086.283.119.365h1.221a2.649 2.649 0 0 1-.222-.626c-.04-.195-.059-.498-.059-.908l.013-1.441c0-.536-.055-.905-.165-1.105-.11-.201-.3-.367-.569-.497-.27-.13-.68-.195-1.23-.195-.607 0-1.064.108-1.371.325-.308.217-.525.55-.65 1.002l1.12.202c.076-.217.176-.369.299-.455.123-.086.294-.13.514-.13.325 0 .546.05.663.152.118.101.176.27.176.508v.123c-.222.093-.622.194-1.2.303-.427.082-.755.178-.982.288-.227.11-.403.268-.53.474a1.327 1.327 0 0 0-.188.706c0 .398.138.728.415.988.277.261.656.391 1.136.391zm.368-.87a.675.675 0 0 1-.492-.189.606.606 0 0 1-.193-.448c0-.176.08-.32.241-.435.106-.07.33-.142.673-.215a7.19 7.19 0 0 0 .751-.19v.247c0 .296-.016.496-.048.602a.773.773 0 0 1-.295.409 1.07 1.07 0 0 1-.637.22zm4.645.765v-1.235h-1.235V14h1.235zM10.2 25.105c.542 0 1.003-.215 1.382-.646.38-.43.57-1.044.57-1.84 0-.771-.187-1.362-.559-1.774a1.82 1.82 0 0 0-1.41-.617c-.522 0-.973.216-1.354.65v-2.32H7.594V25h1.147v-.686a1.9 1.9 0 0 0 .67.592c.26.133.523.2.79.2zm-.299-.975c-.354 0-.638-.164-.852-.492-.153-.232-.229-.59-.229-1.073 0-.468.098-.818.295-1.048a.93.93 0 0 1 .738-.345c.302 0 .55.118.743.354.193.236.29.62.29 1.154 0 .5-.096.868-.288 1.1-.192.233-.424.35-.697.35zm4.478.87v-1.235h-1.234V25h1.234zm-4.017 9.105c.6 0 1.08-.142 1.437-.426.357-.284.599-.704.725-1.261l-1.213-.207c-.061.326-.167.555-.316.688a.832.832 0 0 1-.576.2.916.916 0 0 1-.75-.343c-.185-.228-.278-.62-.278-1.173 0-.498.091-.853.274-1.066.183-.212.429-.318.736-.318.232 0 .42.061.565.184.145.123.238.306.28.55l1.216-.22c-.146-.501-.387-.874-.722-1.119-.336-.244-.788-.366-1.356-.366-.695 0-1.245.214-1.653.643-.407.43-.61 1.03-.61 1.8 0 .762.202 1.358.608 1.788.406.431.95.646 1.633.646zM14.633 34v-1.235h-1.235V34h1.235z"/></svg>'},{label:t("Toggle the upper–latin list style"),tooltip:t("Upper-latin"),type:"upper-latin",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="m7.88 15 .532-1.463h2.575L11.549 15h1.415l-2.58-6.442H9.01L6.5 15h1.38zm2.69-2.549H8.811l.87-2.39.887 2.39zM14.88 15v-1.235h-1.234V15h1.234zM9.352 25c.83-.006 1.352-.02 1.569-.044.346-.038.636-.14.872-.305.236-.166.422-.387.558-.664.137-.277.205-.562.205-.855 0-.372-.106-.695-.317-.97-.21-.276-.512-.471-.905-.585a1.51 1.51 0 0 0 .661-.567 1.5 1.5 0 0 0 .244-.83c0-.28-.066-.53-.197-.754a1.654 1.654 0 0 0-.495-.539 1.676 1.676 0 0 0-.672-.266c-.25-.042-.63-.063-1.14-.063H7.158V25h2.193zm.142-3.88H8.46v-1.49h.747c.612 0 .983.007 1.112.022.217.026.38.102.49.226.11.125.165.287.165.486a.68.68 0 0 1-.192.503.86.86 0 0 1-.525.23 11.47 11.47 0 0 1-.944.023h.18zm.17 2.795H8.46v-1.723h1.05c.592 0 .977.03 1.154.092.177.062.313.16.406.295a.84.84 0 0 1 .14.492c0 .228-.06.41-.181.547a.806.806 0 0 1-.473.257c-.126.026-.423.04-.892.04zM14.88 25v-1.235h-1.234V25h1.234zm-5.018 9.11c.691 0 1.262-.17 1.711-.512.45-.341.772-.864.965-1.567l-1.261-.4c-.109.472-.287.818-.536 1.037-.25.22-.547.33-.892.33-.47 0-.85-.173-1.143-.519-.293-.345-.44-.925-.44-1.74 0-.767.15-1.322.447-1.665.297-.343.684-.514 1.162-.514.346 0 .64.096.881.29.242.193.4.457.477.79l1.288-.307c-.147-.516-.367-.911-.66-1.187-.492-.465-1.132-.698-1.92-.698-.902 0-1.63.296-2.184.89-.554.593-.83 1.426-.83 2.498 0 1.014.275 1.813.825 2.397.551.585 1.254.877 2.11.877zM14.88 34v-1.235h-1.234V34h1.234z"/></svg>'}],l=t("Numbered List"),o=t("Numbered list styles toolbar"),a="numberedList";e.ui.componentFactory.add(a,ef({editor:e,normalizedConfig:s,parentCommandName:a,buttonLabel:l,buttonIcon:r.Pt.numberedList,styleGridAriaLabel:o,styleDefinitions:i})),n.includes("numbered")&&e.ui.componentFactory.add(`menuBar:${a}`,eb({editor:e,normalizedConfig:s,parentCommandName:a,buttonLabel:l,styleGridAriaLabel:o,styleDefinitions:i}))}}}function ef({editor:e,normalizedConfig:t,parentCommandName:i,buttonLabel:r,buttonIcon:s,styleGridAriaLabel:n,styleDefinitions:l}){let o=e.commands.get(i);return u=>{let d=(0,a.yu)(u,a.AO),c=d.buttonView;return d.bind("isEnabled").to(o),d.class="ck-list-styles-dropdown",c.on("execute",()=>{e.execute(i),e.editing.view.focus()}),c.set({label:r,icon:s,tooltip:!0,isToggleable:!0}),c.bind("isOn").to(o,"value",e=>!!e),d.once("change:isOpen",()=>{let r=function({editor:e,normalizedConfig:t,dropdownView:i,parentCommandName:r,styleDefinitions:s,styleGridAriaLabel:n}){let l=e.locale,o={...t,..."numberedList"!=r?{startIndex:!1,reversed:!1}:null},u=r.replace("List",""),d=null;if(t.styles.listTypes.includes(u)){let t=e.commands.get("listStyle"),i=eg({editor:e,parentCommandName:r,listStyleCommand:t}),n=ey(t);d=s.filter(n).map(i)}let c=new eh(l,{styleGridAriaLabel:n,enabledProperties:o,styleButtonViews:d});if(t.styles.listTypes.includes(u)&&(0,a.Zn)(i,()=>c.stylesView.children.find(e=>e.isOn)),o.startIndex){let t=e.commands.get("listStart");c.startIndexFieldView.bind("isEnabled").to(t),c.startIndexFieldView.fieldView.bind("value").to(t),c.on("listStart",(t,i)=>e.execute("listStart",i))}if(o.reversed){let t=e.commands.get("listReversed");c.reversedSwitchButtonView.bind("isEnabled").to(t),c.reversedSwitchButtonView.bind("isOn").to(t,"value",e=>!!e),c.on("listReversed",()=>{let i=t.value;e.execute("listReversed",{reversed:!i})})}return c.delegate("execute").to(i),c}({editor:e,normalizedConfig:t,dropdownView:d,parentCommandName:i,styleGridAriaLabel:n,styleDefinitions:l});d.panelView.children.add(r)}),d.on("execute",()=>{e.editing.view.focus()}),d}}function eg({editor:e,listStyleCommand:t,parentCommandName:i}){let r=e.locale,s=e.commands.get(i);return({label:n,type:l,icon:o,tooltip:u})=>{let d=new a._(r);return d.set({label:n,icon:o,tooltip:u}),t.on("change:value",()=>{d.isOn=t.value===l}),d.on("execute",()=>{s.value?t.value===l?e.execute(i):t.value!==l&&e.execute("listStyle",{type:l}):e.model.change(()=>{e.execute("listStyle",{type:l})})}),d}}function eb({editor:e,normalizedConfig:t,parentCommandName:i,buttonLabel:s,styleGridAriaLabel:n,styleDefinitions:l}){return o=>{let u=new a.zj(o),d=e.commands.get(i),c=e.commands.get("listStyle"),m=ey(c),h=eg({editor:e,parentCommandName:i,listStyleCommand:c}),p=l.filter(m).map(h),f=new eh(o,{styleGridAriaLabel:n,enabledProperties:{...t,startIndex:!1,reversed:!1},styleButtonViews:p});return f.delegate("execute").to(u),u.buttonView.set({label:s,icon:r.Pt[i]}),u.panelView.children.add(f),u.bind("isEnabled").to(d,"isEnabled"),u.on("execute",()=>{e.editing.view.focus()}),u}}function ey(e){return"function"==typeof e.isStyleTypeSupported?t=>e.isStyleTypeSupported(t.type):()=>!0}class ew extends r.k_{static get requires(){return[em,ep]}static get pluginName(){return"ListProperties"}static get isOfficialPlugin(){return!0}}class ev extends r.uB{constructor(e){super(e),this.on("execute",()=>{this.refresh()},{priority:"highest"})}refresh(){let e=this._getSelectedItems();this.value=this._getValue(e),this.isEnabled=!!e.length}execute(e={}){this.editor.model.change(t=>{let i=this._getSelectedItems(),r=void 0===e.forceValue?!this._getValue(i):e.forceValue;for(let e of i)r?t.setAttribute("todoListChecked",!0,e):t.removeAttribute("todoListChecked",e)})}_getValue(e){return e.every(e=>e.getAttribute("todoListChecked"))}_getSelectedItems(){let e=this.editor.model,t=e.schema,i=e.document.selection.getFirstRange(),r=i.start.parent,s=[];for(let e of(t.checkAttribute(r,"todoListChecked")&&s.push(...f(r)),i.getItems({shallow:!0})))t.checkAttribute(e,"todoListChecked")&&!s.includes(e)&&s.push(...f(e));return s}}class eA extends u.$A{domEventType=["change"];onDomEvent(e){if(e.target){let t=this.view.domConverter.mapDomToView(e.target);t&&t.is("element","input")&&"checkbox"==t.getAttribute("type")&&t.findAncestor({classes:"todo-list__label"})&&this.fire("todoCheckboxChange",e)}}}let eI=(0,l.ZX)("Ctrl+Enter");class ek extends r.k_{static get pluginName(){return"TodoListEditing"}static get isOfficialPlugin(){return!0}static get requires(){return[U]}init(){var e;let t=this.editor,i=t.model,r=t.editing,s=t.plugins.get(U),n=t.config.get("list.multiBlock");t.commands.add("todoList",new z(t,"todo")),t.commands.add("checkTodoList",new ev(t)),r.view.addObserver(eA),i.schema.extend("$listItem",{allowAttributes:"todoListChecked"}),i.schema.addAttributeCheck(e=>{let t=e.last;if(!t.getAttribute("listItemId")||"todo"!=t.getAttribute("listType"))return!1},"todoListChecked"),t.conversion.for("upcast").add(e=>{e.on("element:input",(e,t,i)=>{let r=t.modelCursor,s=r.parent,n=t.viewItem;if(!i.consumable.test(n,{name:!0})||"checkbox"!=n.getAttribute("type")||!r.isAtStart||!s.hasAttribute("listType"))return;i.consumable.consume(n,{name:!0});let l=i.writer;l.setAttribute("listType","todo",s),t.viewItem.hasAttribute("checked")&&l.setAttribute("todoListChecked",!0,s),t.modelRange=l.createRange(r)}),e.on("element:li",(e,t,i)=>{let{writer:r,schema:s}=i;if(t.modelRange){for(let[,e]of Array.from(t.modelRange.getItems({shallow:!0})).filter(e=>"todo"===e.getAttribute("listType")&&s.checkAttribute(e,"listItemId")).reduce((e,t)=>{let i=t.getAttribute("listItemId");return e.has(i)||e.set(i,f(t)),e},new Map).entries())if(e.some(e=>e.getAttribute("todoListChecked")))for(let t of e)r.setAttribute("todoListChecked",!0,t)}},{priority:"low"}),e.on("element:label",ex({name:"label",classes:"todo-list__label"})),e.on("element:label",ex({name:"label",classes:["todo-list__label","todo-list__label_without-description"]})),e.on("element:span",ex({name:"span",classes:"todo-list__label__description"})),e.on("element:ul",function(e){let t=new u.PN(e);return(e,i,r)=>{let s=t.match(i.viewItem);if(!s)return;let n=s.match;n.name=!1,r.consumable.consume(i.viewItem,n)}}({name:"ul",classes:"todo-list"}))}),t.conversion.for("downcast").elementToElement({model:n?"paragraph":"listItem",view:(e,{writer:t})=>{if(eT(e,s.getListAttributeNames()))return t.createContainerElement("span",{class:"todo-list__label__description"})},converterPriority:"highest"}),s.registerDowncastStrategy({scope:"list",attributeName:"listType",setAttributeOnDowncast(e,t,i){"todo"==t?e.addClass("todo-list",i):e.removeClass("todo-list",i)}}),s.registerDowncastStrategy({scope:"itemMarker",attributeName:"todoListChecked",createElement(e,t,{dataPipeline:i}){if("todo"!=t.getAttribute("listType"))return null;let r=e.createUIElement("input",{type:"checkbox",...t.getAttribute("todoListChecked")?{checked:"checked"}:null,...i?{disabled:"disabled"}:{tabindex:"-1"}});if(i)return r;let s=e.createContainerElement("span",{contenteditable:"false"},r);return s.getFillerOffset=()=>null,s},canWrapElement:e=>eT(e,s.getListAttributeNames()),createWrapperElement(e,t,{dataPipeline:i}){let r=["todo-list__label"];return eT(t,s.getListAttributeNames())||r.push("todo-list__label_without-description"),e.createAttributeElement(i?"label":"span",{class:r.join(" ")})}}),s.on("checkElement",(e,{modelElement:t,viewElement:i})=>{let r=eT(t,s.getListAttributeNames());i.hasClass("todo-list__label__description")!=r&&(e.return=!0,e.stop())}),s.on("checkElement",(e,{modelElement:i,viewElement:r})=>{let s="todo"==i.getAttribute("listType")&&y(i),n=!1;for(let{item:e}of t.editing.view.createPositionBefore(r).getWalker({direction:"backward"})){if(e.is("element")&&t.editing.mapper.toModelElement(e))break;e.is("element","input")&&"checkbox"==e.getAttribute("type")&&(n=!0)}n!=s&&(e.return=!0,e.stop())}),s.on("postFixer",(e,{listNodes:t,writer:i})=>{for(let{node:r,previousNodeInList:s}of t){if(!s||s.getAttribute("listItemId")!=r.getAttribute("listItemId"))continue;let t=s.hasAttribute("todoListChecked"),n=r.hasAttribute("todoListChecked");n&&!t?(i.removeAttribute("todoListChecked",r),e.return=!0):!n&&t&&(i.setAttribute("todoListChecked",!0,r),e.return=!0)}}),i.document.registerPostFixer(e=>{let t=i.document.differ.getChanges(),r=!1;for(let i of t)if("attribute"==i.type&&"listType"==i.attributeKey){let t=i.range.start.nodeAfter;"todo"==i.attributeOldValue&&t.hasAttribute("todoListChecked")&&(e.removeAttribute("todoListChecked",t),r=!0)}else if("insert"==i.type&&"$text"!=i.name)for(let{item:t}of e.createRangeOn(i.position.nodeAfter))t.is("element")&&"todo"!=t.getAttribute("listType")&&t.hasAttribute("todoListChecked")&&(e.removeAttribute("todoListChecked",t),r=!0);return r}),this.listenTo(r.view.document,"keydown",(e,i)=>{(0,l.QC)(i)===eI&&(t.execute("checkTodoList"),e.stop())},{priority:"high"}),this.listenTo(r.view.document,"todoCheckboxChange",(e,t)=>{let i=t.target;if(!i||!i.is("element","input"))return;let s=r.view.createPositionAfter(i),n=r.mapper.toModelPosition(s).parent;n&&p(n)&&"todo"==n.getAttribute("listType")&&this._handleCheckmarkChange(n)}),this.listenTo(r.view.document,"arrowKey",(e=t.locale,(t,r)=>{let s=(0,l.Kf)(r.keyCode,e.contentLanguageDirection),n=i.schema,o=i.document.selection;if(!o.isCollapsed)return;let a=o.getFirstPosition(),u=a.parent;if("right"==s&&a.isAtEnd){let e=n.getNearestSelectionRange(i.createPositionAfter(u),"forward");if(!e)return;let s=e.start.parent;s&&p(s)&&"todo"==s.getAttribute("listType")&&(i.change(t=>t.setSelection(e)),r.preventDefault(),r.stopPropagation(),t.stop())}else if("left"==s&&a.isAtStart&&p(u)&&"todo"==u.getAttribute("listType")){let e=n.getNearestSelectionRange(i.createPositionBefore(u),"backward");if(!e)return;i.change(t=>t.setSelection(e)),r.preventDefault(),r.stopPropagation(),t.stop()}}),{context:"$text"}),this.listenTo(r.mapper,"viewToModelPosition",(e,t)=>{let r=t.viewPosition.parent,s=r.is("attributeElement","li")&&0==t.viewPosition.offset,n=e_(r)&&t.viewPosition.offset<=1,l=r.is("element","span")&&"false"==r.getAttribute("contenteditable")&&e_(r.parent);if(!s&&!n&&!l)return;let o=t.modelPosition.nodeAfter;o&&"todo"==o.getAttribute("listType")&&(t.modelPosition=i.createPositionAt(o,0))},{priority:"low"}),this._initAriaAnnouncements()}_handleCheckmarkChange(e){let t=this.editor,i=t.model,r=Array.from(i.document.selection.getRanges());i.change(i=>{i.setSelection(e,"end"),t.execute("checkTodoList"),i.setSelection(r)})}_initAriaAnnouncements(){let{model:e,ui:t,t:i}=this.editor,r=null;t&&e.document.selection.on("change:range",()=>{let s=e.document.selection.focus.parent,n=eS(r),l=eS(s);n&&!l?t.ariaLiveAnnouncer.announce(i("Leaving a to-do list")):!n&&l&&t.ariaLiveAnnouncer.announce(i("Entering a to-do list")),r=s})}}function ex(e){let t=new u.PN(e);return(e,i,r)=>{let s=t.match(i.viewItem);s&&r.consumable.consume(i.viewItem,s.match)&&Object.assign(i,r.convertChildren(i.viewItem,i.modelCursor))}}function eT(e,t){return(e.is("element","paragraph")||e.is("element","listItem"))&&"todo"==e.getAttribute("listType")&&y(e)&&function(e,t){for(let i of e.getAttributeKeys())if(!i.startsWith("selection:")&&!t.includes(i))return!1;return!0}(e,t)}function e_(e){return!!e&&e.is("attributeElement")&&e.hasClass("todo-list__label")}function eS(e){return!!(e&&(e.is("element","paragraph")||e.is("element","listItem")))&&"todo"==e.getAttribute("listType")}class eV extends r.k_{static get pluginName(){return"TodoListUI"}static get isOfficialPlugin(){return!0}init(){let e=this.editor.t;Y(this.editor,"todoList",e("To-do List"),r.Pt.todoList)}}class eL extends r.k_{static get requires(){return[ek,eV]}static get pluginName(){return"TodoList"}static get isOfficialPlugin(){return!0}}function eE(e,t){let i=[],r=e.parent,s=r.getAttribute("listIndent");for(let n of[...new u.rU({ignoreElementEnd:!1,startPosition:e,shallow:!0,direction:t})].filter(e=>e.item.is("element")).map(e=>e.item)){if(!n.is("element","listItem")||n.getAttribute("listIndent")<s)break;if(!(n.getAttribute("listIndent")>s)){if(n.getAttribute("listType")!==r.getAttribute("listType")||n.getAttribute("listStyle")!==r.getAttribute("listStyle")||n.getAttribute("listReversed")!==r.getAttribute("listReversed")||n.getAttribute("listStart")!==r.getAttribute("listStart"))break;"backward"===t?i.unshift(n):i.push(n)}}return i}r.uB,r.uB,r.uB}}]);
//# sourceMappingURL=47a4d693.0771b4fd3bcd3fd6.js.map